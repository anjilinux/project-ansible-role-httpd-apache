---
## TODO: Remember to adapt goss tests to your convenience

#service:
#  apache_httpd:
#    enabled: true
#    running: true
#
#process:
#  apachectl:
#    running: true
#
#user:
#  exampleuser:
#      exists: true
#      groups:
#        - examplegroup
#      shell: /usr/sbin/nologin
#group:
#  examplegroup:
#    exists: true
#
#file:
#  /opt/apache_httpd:
#    
#    owner: exampleuser
#    group: examplegroup
#    
#    exists: true
#    filetype: directory
#  /opt/apache_httpd/bin:
#    
#    owner: exampleuser
#    group: examplegroup
#    
#    exists: true
#    filetype: directory

## Check if ports are really exposed
# port:
# # Check port at IPv6
# # https://github.com/aelsabbahy/goss/issues/177
#   tcp6:<port>:
#     listening: true
#     ip:
#     - '::'


http:
  http://localhost:{{ apache_port }}:
    status: 200
  http://localhost:{{ apache_port }}/example1/:
    status: 200
    body:
      - "idealista is awesome"

service:
  apache2:
    enabled: true
    running: true

file:
  {{ apache_install_dir }}:
    exists: true
    filetype: directory
    mode: "0755"
    owner: root
    group: root
  /usr/bin/apachectl:
    exists: true
    filetype: symlink
    linked-to: {{ apache_install_dir }}/bin/apachectl

user:
  {{ apache_user }}:
    exists: true
    groups:
      - {{ apache_group }}

group:
  {{ apache_group }}:
    exists: true

port:
  tcp:80:
    listening: true
